<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-06-18 Tue 10:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Derivação automática</title>
<meta name="author" content="Nemo" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="./my-css.css"/>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Derivação automática
<br />
<span class="subtitle">Recap e aproximação por diferenças finitas</span>
</h1>
<div id="outline-container-orgb62d15c" class="outline-2">
<h2 id="orgb62d15c"><span class="section-number-2">1.</span> Objetivos</h2>
<div class="outline-text-2" id="text-1">
<p>
Essa serie vai tentar explicar os conceitos e motivações por trás da
ideia conhecida por "derivação automática". Começaremos por uma revisão das
ideias básicas de calculo (de modo breve), veremos como "computar" aproximações
numéricas e expressões simbólicas da derivada de uma função, e as limitações e
problemas desses métodos. Finalmente então implementaremos uma pequena
biblioteca do que é conhecido por diferenciação automática "Forward mode".
</p>
</div>
<div id="outline-container-orge3d8145" class="outline-3">
<h3 id="orge3d8145"><span class="section-number-3">1.1.</span> Nosso plano</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li>Introdução</li>
<li>Recap de calculo</li>
<li>Implementar diferenças finitas</li>
<li>(talvez) implementar diferenciação simbólica</li>
<li>Base teorica do autodiff</li>
<li>Implementação de autodiff</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org8a2fd88" class="outline-2">
<h2 id="org8a2fd88"><span class="section-number-2">2.</span> Recapitulando: Derivação</h2>
<div class="outline-text-2" id="text-2">
<p>
O quanto uma função \(F(x) = y\), com \(x, y \subset \mathbb{R}\),
muda conforme \(x\) varia é chamado de derivada.
</p>

<p>
A velocidade é um exemplo claro de como a derivação representa a mudança.
Se a posição de um carro que se move é descrita por \(p(t)\), sua velocidade
vai ser a derivada da posição em função de \(t\) e sua aceleração a derivada da
derivada (a variação da variação), ou em "termos matemáticos":
</p>
\begin{equation}
Velocidade = v(t) = \frac{dp(t)}{dt}
\end{equation}
\begin{equation}
Aceleração = a(t) = \frac{dv(t)}{dt} = \frac{d^{2}p(t)}{d^{2}t}
\end{equation}

<p>
A derivada de função \(F(x)\) é formalmente definida utilizando limites:
</p>
\begin{equation}                     
\frac{dF(x)}{dt} =\lim_{h\to 0} \frac{F(x + h) - F(x)}{h} 
\end{equation}

<p>
Para uma função de uma dimensão, graficamente isso pode ser visto como tentar
encontrar a reta tangente a um ponto especifico, ou em outras palavras: uma
aproximação linear daquela função.
</p>

<div id="org7b0895b" class="figure">
<p><img src="./img/tangent_line.png" alt="tangent_line.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Derivada de \(F(x)\) com \(x=a\) e \(x=b\)</p>
</div>

<p>
Utilizando as propriedades de limites é possível determinar o comportamento para
maioria das operações realizadas nos espaços "normais", é dai que vem as tabelas
de derivação. As tabelas de derivação apresentam um conjunto de <b>regras
simbólicas</b> para manipular essas expressões, como por exemplo as presentes na Tabela 1.
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">
<caption class="t-above"><span class="table-number">Table 1:</span> Algumas regras de derivação simbólica</caption>

<colgroup>
<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Comentário</th>
<th scope="col" class="org-center">\(Expr\)</th>
<th scope="col" class="org-center">\(\frac{d(Expr)}{dx}\)</th>
<th scope="col" class="org-center">Exemplo</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">Regra da adição</td>
<td class="org-center">\(F \pm W\)</td>
<td class="org-center">\(F' \pm W'\)</td>
<td class="org-center">\(x^{3}-x^{2} \Rightarrow 3\cdot x^{2} - 2\cdot x^{}\)</td>
</tr>

<tr>
<td class="org-center">Regra do produto</td>
<td class="org-center">\(F * W\)</td>
<td class="org-center">\(F' \cdot W + W' \cdot F\)</td>
<td class="org-center">\(e ^ {x} \cdot x^{2} \Rightarrow e^{x}\cdot x^{2} + 2\cdot x \cdot e^{x}  \)</td>
</tr>

<tr>
<td class="org-center">Regra da cadeia</td>
<td class="org-center">\(F(W(x))\)</td>
<td class="org-center">\(F'(G(x)) \cdot G'(x)\)</td>
<td class="org-center">\(sin(x)\circ x^{2} \Rightarrow\ cos(x^{2}) \cdot 2 \cdot x\)</td>
</tr>

<tr>
<td class="org-center">Regra para reciproca</td>
<td class="org-center">\(\frac{1}{F}\)</td>
<td class="org-center">\(\frac{-F'}{F^{2}}\)</td>
<td class="org-center">\(\frac{1}{x} \Rightarrow -\frac{1}{x^{2}}\)</td>
</tr>

<tr>
<td class="org-center">Regra para polinômios</td>
<td class="org-center">\(x ^ {n}\)</td>
<td class="org-center">\(n \cdot x^{n - 1}\)</td>
<td class="org-center">\(x ^ {5} \Rightarrow 5 \cdot x^{4}\)</td>
</tr>

<tr>
<td class="org-center">Constantes, números</td>
<td class="org-center">K</td>
<td class="org-center">0</td>
<td class="org-center">\(42 \Rightarrow 0\)</td>
</tr>

<tr>
<td class="org-center">&ctdot;</td>
<td class="org-center">&ctdot;</td>
<td class="org-center">&ctdot;</td>
<td class="org-center">&ctdot;</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-orgcfa6051" class="outline-3">
<h3 id="orgcfa6051"><span class="section-number-3">2.1.</span> Notação</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Calculo possui uma historia um pouco complicada com notações. Existem varias, e
dependendo da situação convém usar uma ou outra. Todas são um pouco confusas.
A derivada de uma função \(F(x)\) pode ser representada:
</p>
<ul class="org-ul">
<li>Com um apóstrofo ou similar: \(F'(x)\)</li>
<li>Com um circulo sobre o nome da função: \(\dot F\)</li>
<li>Como um operador D(iferencial): \(D F(x)\)</li>
<li>Como uma especie de razão entre a função e um "infinitesimal": \( \frac{dF}
   {dx} \)</li>
</ul>
<p>
Quase todas podem ser estendidas para tratar de derivadas de ordem maior e/ou
derivadas parciais, que não cobriremos aqui.
</p>


<p>
Para saber mais:
</p>
<ul class="org-ul">
<li>Introdutório : <a href="https://www.youtube.com/watch?v=6v0SMTZ8hkU">https://www.youtube.com/watch?v=6v0SMTZ8hkU</a></li>
<li>Introdutório : Um Curso de Cálculo - Vol. 1, Hamilton Luiz Guidorizzi</li>
<li>Avançado / rigoroso : Calculus on Manifolds, Michael Spivak,  1965</li>
</ul>
</div>
</div>

<div id="outline-container-org560d99f" class="outline-3">
<h3 id="org560d99f"><span class="section-number-3">2.2.</span> Diferenças finitas</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Para de fato calcularmos essa função em um ponto utilizando computadores,
podemos utilizar uma aproximação. Isso é feito dando valores pequenos para \(h\)
em vez de usar um limite. Essa aproximação então é:
</p>
\begin{equation}                     
F'(x) \approx \frac{F(x + h) - F(x)}{h} \
\end{equation}
<p>
<img src="./img/forward.png" alt="forward.png" />
A equação anterior aproxima a derivada como um "passo" para frente, mas é
possível também aproximá-la como um passo para trás:
</p>
\begin{equation}                     
F'(x) \approx \frac{F(x) - F(x-h)}{h} \
\end{equation}
<p>
<img src="./img/backward.png" alt="backward.png" />
Ou meio passo para frente e meio para trás:
</p>
\begin{equation}                     
F'(x) \approx \frac{F(x + \frac{h}{2}) - F(x - \frac{h}{2})}{h} \
\end{equation}
<p>
<img src="./img/centered.png" alt="centered.png" />
As formulas que envolvem somente uma direção se comportam de modo similar em
precisão e estabilidade, mas a diferença "centrada" tem um erro menor.
</p>
</div>
</div>
<div id="outline-container-org9cfca35" class="outline-3">
<h3 id="org9cfca35"><span class="section-number-3">2.3.</span> Implementação de diferenças finitas</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Primeiramente convém definir algumas funções que vão nos auxiliar a extrair e
plotar os resultados.
</p>
</div>
<div id="outline-container-org766c3a3" class="outline-4">
<h4 id="org766c3a3"><span class="section-number-4">2.3.1.</span> Funções auxiliares</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="org-src-container">
<pre class="src src-scheme" id="org3ccab90">(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">range</span> from by to)
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">Fun&#231;&#227;o que gera um intervalo numerico de [from] em passos [by] at&#233; [to].</span>
  (<span style="color: #cf4f5f; font-weight: bold;">if</span> (&gt;= from to)
      '()
      (cons from (range (+ by from) by to))))

(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">log10-range</span> start decades n-per-decade)
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">fun&#231;&#227;o que gera um intervalo de [n-per-decade] pontos espa&#231;ados de modo uniforme</span>
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">em uma decada, em (- [decades] [start]) decadas.</span>
  (<span style="color: #cf4f5f; font-weight: bold;">let</span> ([decades (range start 1 decades)]
        [points (range 1 (/ 10 n-per-decade) 10)])
    (apply append
           (<span style="color: #cf4f5f; font-weight: bold;">map</span> (<span style="color: #cf4f5f; font-weight: bold;">lambda</span> (decade)
                  (<span style="color: #cf4f5f; font-weight: bold;">map</span> (<span style="color: #cf4f5f; font-weight: bold;">lambda</span> (point)  (* point (expt 10.0 decade))) points))
                decades))))

(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">relative-error</span> aproximation actual-value)
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">calcula o erro relativo entre duas coisas. err = (abs (a - b) / a)</span>
  (abs (/  (- aproximation actual-value) actual-value)))


(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">print-row-with-spaces</span> lst)
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">imprime uma lista [lst] com seus elementos separados por " " e termina com \n.</span>
  (format #t <span style="color: #3fafcf;">"~{~a~^ ~}~%"</span> lst))

(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">print-dataset</span> . list-of-lists)
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">imprime o dataset todo</span>
  (apply  for-each (<span style="color: #cf4f5f; font-weight: bold;">lambda</span> x (print-row-with-spaces x))  list-of-lists))
</pre>
</div>
</div>
</div>
<div id="outline-container-orge5d6b2f" class="outline-4">
<h4 id="orge5d6b2f"><span class="section-number-4">2.3.2.</span> Função de exemplo</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Para demonstrar as formas de se calcular a aproximação por diferenças finitas,
convém escolher uma função. Escolhi, por nenhuma razão especifica, utilizar um
seno amortecido:
</p>
\begin{equation}
\sin\left(x\right) \cdot e^{\frac{-x}{5}}
\end{equation}
<p>
Que tem como derivada:
</p>
\begin{equation}
-\frac{\mathrm{e}^{-\frac{x}{5}} \left(\sin\left(x\right) - 5 \cos\left(x\right)\right)}{5}
\end{equation}
<p>
Suas definições em scheme são representadas abaixo.
</p>
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">my-test-func</span> x)
  <span style="color: #b07f7f; font-style: italic;">;; </span><span style="color: #b07f7f; font-style: italic;">e^(-x/5) * sin(x)</span>
  (* (sin x) (exp (/ (* -1 x) 5))))

(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">my-test-derivative</span> x)
  <span style="color: #b07f7f; font-style: italic;">;;</span><span style="color: #b07f7f; font-style: italic;">-(e^(-x / 5) * (sin(x) - 5 * cos(x))) / 5</span>
  (* -1 (/ (* (exp (/ (* -1 x) 5)) (- (sin x) (* 5 (cos x)))) 5)))

</pre>
</div>
<p>
Os dois blocos de codigo abaixo gravam e leem os resultados dessa função e sua
derivada em um arquivo, e plotam o resultado para \([0,20]\). O processo de
escrita no arquivo <b>é realizada pelo org-mode</b> que executa o codigo scheme,
coleta a saida, e salva. Já a leitura e plotagem são feitas no gnuplot (voce
também pode usar python, R ou sua linguagem favorita para plotar).
</p>
<div class="org-src-container">
<pre class="src src-scheme" id="orgf80a1c6">(<span style="color: #cf4f5f; font-weight: bold;">let*</span> ([dominio (range 0 0.5 20)]
       [plot-test-func  (<span style="color: #cf4f5f; font-weight: bold;">map</span> my-test-func dominio)]
       [plot-test-Dfunc (<span style="color: #cf4f5f; font-weight: bold;">map</span> my-test-derivative dominio)])
  (print-dataset dominio plot-test-func plot-test-Dfunc))
</pre>
</div>


<div class="org-src-container">
<pre class="src src-gnuplot"><span style="color: #b07f7f; font-style: italic;"># </span><span style="color: #b07f7f; font-style: italic;">Script gnuplot</span>
<span style="color: #d24f7f;">reset</span>
<span style="color: #d24f7f;">set</span> <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Funcao {e^{-x/5}}  * {sin(x)} e sua derivada exata"</span>
<span style="color: #d24f7f;">set</span> xlabel <span style="color: #3fafcf;">"x"</span>
<span style="color: #b07f7f; font-style: italic;">#</span><span style="color: #b07f7f; font-style: italic;">plota a as duas fun&#231;&#245;es</span>
<span style="color: #cf4f5f; font-weight: bold;">plot</span> data u 1:2 w l <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"f(x)"</span>, data u 1:3 w l  <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"D f(x)"</span>
</pre>
</div>


<div id="org574306f" class="figure">
<p><img src="./results/img/func-e-deriv.png" alt="func-e-deriv.png" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-scheme" id="org038ac66">(<span style="color: #cf4f5f; font-weight: bold;">define</span> (<span style="color: #a6699f;">aprox-d</span> f h x)
  (/ (- (f (+ x h)) (f x)) h))

(<span style="color: #cf4f5f; font-weight: bold;">let*</span> ([dominio (range 0 0.5 20)]
       [plot-exact-Dfunc (<span style="color: #cf4f5f; font-weight: bold;">map</span> my-test-derivative dominio)]
       [plot-aprox-Dfunc-e9  (<span style="color: #cf4f5f; font-weight: bold;">map</span> (<span style="color: #cf4f5f; font-weight: bold;">lambda</span> (x) (aprox-d my-test-func 1e-9 x)) dominio)]
       [plot-aprox-Dfunc-e12 (<span style="color: #cf4f5f; font-weight: bold;">map</span> (<span style="color: #cf4f5f; font-weight: bold;">lambda</span> (x) (aprox-d my-test-func 1e-12 x)) dominio)]
       [plot-aprox-Dfunc-e15 (<span style="color: #cf4f5f; font-weight: bold;">map</span> (<span style="color: #cf4f5f; font-weight: bold;">lambda</span> (x) (aprox-d my-test-func 1e-15 x)) dominio)])
  (print-dataset dominio plot-exact-Dfunc plot-aprox-Dfunc-e9 plot-aprox-Dfunc-e12 plot-aprox-Dfunc-e15))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-gnuplot"><span style="color: #b07f7f; font-style: italic;"># </span><span style="color: #b07f7f; font-style: italic;">Script gnuplot</span>
<span style="color: #d24f7f;">reset</span>

<span style="color: #d24f7f;">set</span> xlabel <span style="color: #3fafcf;">"x"</span>
<span style="color: #d24f7f;">set</span> multiplot layout 2,2 columns
<span style="color: #b07f7f; font-style: italic;">#</span><span style="color: #b07f7f; font-style: italic;">plota a as duas fun&#231;&#245;es</span>
<span style="color: #cf4f5f; font-weight: bold;">plot</span> data u 1:2 w l <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Df exata(x)"</span>
<span style="color: #cf4f5f; font-weight: bold;">plot</span> data u 1:3 w l  <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Df(x) aproximada h=e-9"</span>
<span style="color: #cf4f5f; font-weight: bold;">plot</span> data u 1:4 w l  <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Df(x) aproximada h=e-12"</span>
<span style="color: #cf4f5f; font-weight: bold;">plot</span> data u 1:5 w l  <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Df(x) aproximada h=e-15"</span>
<span style="color: #d24f7f;">unset</span> multiplot
</pre>
</div>


<div id="org758df9a" class="figure">
<p><img src="./results/img/aprox-and-exact.png" alt="aprox-and-exact.png" />
</p>
</div>


<div class="org-src-container">
<pre class="src src-scheme" id="orgd13b188">
</pre>
</div>



<div class="org-src-container">
<pre class="src src-gnuplot"><span style="color: #b07f7f; font-style: italic;"># </span><span style="color: #b07f7f; font-style: italic;">Script gnuplot</span>
<span style="color: #d24f7f;">reset</span>
<span style="color: #d24f7f;">set</span> <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Erro relativo em relacao ao tamanho de h"</span>
<span style="color: #d24f7f;">set</span> xlabel <span style="color: #3fafcf;">"h"</span>
<span style="color: #d24f7f;">set</span> logscale x 10
<span style="color: #d24f7f;">set</span> logscale y 10
<span style="color: #b07f7f; font-style: italic;">#</span><span style="color: #b07f7f; font-style: italic;">plota a as duas fun&#231;&#245;es</span>
<span style="color: #cf4f5f; font-weight: bold;">plot</span> data u 1:2 <span style="color: #3f9aaf;">with</span> line  <span style="color: #3f9aaf;">title</span> <span style="color: #3fafcf;">"Erro relativo de DF(x)"</span>
</pre>
</div>


<div id="orgdb1a934" class="figure">
<p><img src="./results/img/log-error.png" alt="log-error.png" />
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nemo</p>
<p class="date">Created: 2024-06-18 Tue 10:50</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
